language: java
dist: trusty
sudo: false
jdk:
- oraclejdk8
node_js:
- 8.2.1
install:
- npm install newman
before_script:
- node --version
- npm --version
- ls -la node_modules
- node_modules/.bin/newman --version
script:
- "./.ci.sh"
- ls -l app/target
- cp app/target/sign*.jar .
- nohup java -jar sign*.jar --spring.profiles.active=default &
- ls -l
- ./app/wait-for-it.sh -t 0 localhost:8080 -- echo "signsatwork is up"
- node_modules/.bin/newman run app/testsAPI/User.postman_collection.json -e app/testsAPI/Local.postman_environment.json
- node_modules/.bin/newman run app/testsAPI/Community.postman_collection.json -e app/testsAPI/Local.postman_environment.json
- node_modules/.bin/newman run app/testsAPI/Favorite.postman_collection.json -e app/testsAPI/Local.postman_environment.json
- node_modules/.bin/newman run app/testsAPI/Request.postman_collection.json -e app/testsAPI/Local.postman_environment.json
- node_modules/.bin/newman run app/testsAPI/Sign.postman_collection.json -e app/testsAPI/Local.postman_environment.json
cache:
  directories: "$HOME/.m2"
before_deploy:
- export ARTEFACT=$(ls *.jar)
- echo Will deploy $ARTEFACT
deploy:
  provider: releases
  api_key:
    secure: XwFQS96AvxNX2W4F0DUVDVtwzmltkSmFeH3XUP8M9fThoLO6mVJOH47/GiouVFh2muyCv23Dz+w4qfzHgqIMyJiDO0TzP6Htq1QHVAulmZXYUP8lKvVo9oRm4cSIC0gwfpGJ5JPFA98vSVSDz2xMCN1mlzxVD2Lc2z0EKgKZEa4IfYQ0wftsYqAWeGVEGWAvimp96GDnxZqD00nI7J5zoR1DmgmAylBROMxP2qZCvyfb82x0FnhIleT8YnO0SWZ0/LV0qi6+mjTMzcAu2EnGB/XyOelNUK0EwEXtB4yB+W+oTHg4EShDE5zWiUcNESWBSe0BohNo3P2wwI4BghlQDFYFkTxxzjwqS5EFCqXgtXMJdEDIPlurbuBbxYfVi+40nlAnOQtCTYNmOTpdg4F+k4+DGt+ydZLkNlBGyZnucEnJGObmQu/CjcnuZa1mOZGon6R0hyk2ssTIFixKgCihwFdADn53eohEsStGbaN5j84bTfmIJ6YVFKaIPq+LWzLgnUxBtlZe0cofqrIChXMCTr0DZjvTKkZexyazLLJl6y65y8HZ0OxkdCsr9+MwdiCGxADBX/DOxr5Py3GmsHLkOu2aYOovtEpHGTPYjAvxN5bMeItfUjw91dfazEizl4k7eximS+pnUvWvtax21w4X9PXjPq07Zg7X9lq8xrvWcvU=
  file: "${ARTEFACT}"
  skip_cleanup: true
  on:
    tags: true
    repo: Orange-OpenSource/signs-at-work-social-network-dictionnary
notifications:
  email:
    on_success: change
    on_failure: always
    recipients:
    - denis.boisset@orange.com
env:
  global:
  - secure: OmfHxj6POXqhAL9rM5O8GVd2/YkcQ5V1tsKGEsmOSLUlRvMTR9PVm4HzkCM7A21ElFEwL9uMVvdJZtasYbWxvrKsKcB7winxeMcohWUZitUgDNls6Ff3OHeyW0s0iyKQ4e0H2nlDxSG+CvXkCV3T8N+bCKdULfkBd0ZfxYHJAKF1CELtsZoaxKK9jdlNYlb7JM1ThDu5mogkuwX/eKNocj5U27zHHp+P4Tpt5lLS5vcqlD1dgnjBiQPPLjhF4H6oqVKg6+XYT46fz2ap4167nlRoYqNqQshWI4tujClmMCx0s6P9hPN9+tijCSk1Bi5R1UA391zW0DKa2OYXAJu2P6QMiD0E2S92fLCnlZmfmgc7cFx6ZJErI5q9chMHQLjmab2bOMhHdWHOA+xkmAkHoBIpelrk33m5Zic2tdD7KamnofIa0/zz/mY8wBDTdIfb9P52RpWOk3cJzDA+8W2NWeDhi9shKuEpWH+2IZcnXAvZEAlDV+sKh0M/umZ3uL/2zlpgfR8a1BA6S9Opdw3oWFh5O4fDYsgIV9ASvoREJdanX1F18csvp+LOyuI0HHnZsapLN/om0UilbjNWpc1EPlH+xxuXjsC5JTJwLjN77DfwiB1OqUvNjJ1HwzsuZRPybEmsWJgZWc7QlsI0BaEW51tDrOrxCKXoptByVzdALcI=
  - secure: qc7jh6skz0jfIkEEmUoTuCfPFY6ksq8iHUx1S/k1NxVPRwgfnz4YfYBUNQy0yE1nAiTLzZPAeUBNPWtmLz8jD630M2L7lWX392aNrj4iSXhaUcLUJhs4owrAQ0O90ILZo2vcmWnEHNB4NsvLllJjJZpwVBBnPDuiu9D5jSontGEarzcvkWuYUmog8INXXGAJ9BNbM7xcDSDrn4aWSDKEJ7UIGD52lMk+ZsmqMc14pgC38a4n0FDqcupMzGWHXg6Z5lNqOAFgEUtJX6Jtz4y7Dhk1gZl6H3YmOCUOfOfrnlUDV8FAuxN/FpgXrgZpnEQ23Fkkn83tPUcrpY/CB3+j/SyqVm8UEZilNQPUb/GW/XoD7jsxmltRs8qwfwwRJUu418H5e0q+ZLnwGprt25keOhIB6TKTHeJn9ndkn8d2sJ5/VPQerWPCYdFFUiSMu3DaTerub6fmrHnw8OvmCeha6sUaRe20IqsV2IxRxfKsLtIpfuG82q93UPClEeX+QxGQbcExhfPVzEAjoMPs+GMX5BQ6LseNWaNWvGqq2JBYTFw4iycfHoDIyCFgmWu+EbzB9hzjCu/6TFERwexaYJ4qAvPu/2oF5Ch5nC+ianvTAIerQxhql6fyHXYdnR0dKhNj9wjM72EoPRWYQ0/HcRrPw4mCWJwxpbdll9OFJvWboHM=
  - secure: czziuOkzpOD/8qyoB5K2tDfH8tdDATSapNAwCABy25qLrjremUsahKYKiE7fMi0MyQwesC1PqqTkuHjtFctDO3djqQXMapx/5dAUG9x7mXDyEaYn95sdzAzMEhwM3zD/NoSaNnDIx9GLlWDQ9jFrkyieT/KiPwq53+o0t2uHp7v8COFz/syVS+zGW0tRIMRX1DTqzbhx+tEdnyfPxfjgGRhVDR1IBCTjyNj7MQ7vLk6v+pIoN52Zpf7XR/UgcKQ4XCivTVuQ/E/3dt4Nzsk4ntYX2u+quKymfdNGdjvf1/cX3RIQmrHmwfjcN0V4Jd3ItgOu6Jxavt/q9eOkmbrWw2Cf6KwTFp5z1A7yu1ljBpIvJT5d28Jkp3iS/ddbd+v7L/nJKGJjQR89FzlHfggxp8+DkBspZEfr7Git06dRqagkQfcld6mgUdFBbNm5ubV48DIClZeya2un4fMYhSLV3qnFIw5GcuH7i0wAToBKoTTuKtM9XUCbq2inVYUmTbzGQA23y9cirQlemN3DaPDgDnZIBathCMV/otALIXnNqFvH5GqDrBrsJUnkVVy7air+MNi+szoUuh8Kn3T0+d2BiLvxTqO3a2332trsIukUGEcFBB+R01aH033nCveMrNWFtgeNIPSLGTOgB492DrSEMzbcYM+X5fWh0q6TIG7RsJI=
  - secure: ZjOBn+SwdbZua/alp07tpIf+X+U9m2Ra4NpSQiUa4JC7wljM3nE8RxODjtcu0RFiVZyFBCkD2weCR6eU6A2ncDrqujoXQH6uLk24+EE1xkuvidRvQwfzCAM309eV3MQAnHFqOgmy8WKdbPJZYsllZv3pWYAlM9WvHblPAwoa6RHAsm9Y4ePa7wN05PzP0gdUc61ZMbvvNnlvFP3Uq/bQxccEcf+J54BZqmxracSmvrC1KLgjpEijXlev7pVAw2FZeqeJAPJPcYfNfaEFLbtx5t+ntSnca4VkErStuLgoM+/7QKhQ/dduvMEOjJ4X7nHCGLItUh4imFvDrl5E2Qbxxy9MFNXs+r9iEzA2RdSc5JBt1R9pv8UEPIecnxklu26ECCAa+hNtrrDy5Dyb8b4/adN9G3jcC5o12ZQhPu8WPzo4OGOOTufbbZFFftj/XoEN1Xwv76SVIpxCZiNF/+6XDsDEmF5H8zSeacB2b1XC6gtSrTwfDOgnZ6yzRS1RcuNcmiRLA9s8Lt121hyNOisnRn6HYGaeld0y5hmZWVlQOZKo+EhE6DdUchGhGGmo/q4rtVGsS6qJU+IhgjgOVwbWG5+N6cZF/lqCYyU8d7LkZeJorxtMsF4p8eBszOJhIPXf/8wrtHS/AM1JZgALAVIlYbnUBwTHVCA0v/HitiI6HX8=
  - secure: CgLE9eC+3wlFJiASX0PF4P/teDJt0to/uymAw8GxHVx0cyJ/bXAsf0Su80jCDcDsJQ3mx/Xycan6VZAmy6O7Y0k+6hIU9tfFmg4JqA9DXRXOB314dxbee3X5z0FJ8kJ5jgXmjZl8R1qP/77oBEnTBAU9fRJxjbQAz3worYxNN1TFQEc02FReqOJ3+k2JSaNg3ekUJnomrwkNVLuZkDjcuIFOmKKuIGFIKU0jFako/qgysOQk1rYkjbLnWr5fitaovUCdt8+rVvWRjhHVHm/KUuQYioJHyLEYIg5s8JIDHHgRIAOyJRTROfBaO5mGvEknEJSATwRkMtzpxEG2b9+WiXm1VzdlZKhxUV/s/Jf7cxQhd6+fLzZ+zEIp7s1j3nQfizoRF7fFACayhvdu0LrCpvUdR8FpAcg897tXMtsLkS5dseA9MGu1PPY8KsimOrN2uU9D1peSAXLrHfQ4P0o7NVDzzIUZv+qazCnj2JNaBpEbu2n5cdJzD+XoWRl5pKhEffMJlUR1LTYOf0dcckQo7bYDoa7sZx11hfdU6qpMq/4YfFCTa1HUcgK+TZrK9l48hvl7rYPC91rb4DIYjvT7Z3H+U0Zmmw9zk9ktPI3fI1OZSR5j0Jq9reZxb9NeliYVVWBcjHbXrawuDBJnBqAX4a+l/YhMHBpZtwqSjfIaBCs=
